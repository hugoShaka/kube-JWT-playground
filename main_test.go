package main

import (
	"github.com/stretchr/testify/require"
	"testing"
)

func TestValidateToken(t *testing.T) {
	jwks := `{"keys":[{"use":"sig","kty":"RSA","kid":"wY_KzGuIVif_V_Jc-4PEr0rm3SdVxl_tG0uAAdNa7X8","alg":"RS256","n":"xKqzyOL32iqfTEn7Bc-Ll_4XA0pQHI52XZzoIKRHLErMRwrVcA6zaYNzLFuhfJvwrf5VXhDgxFE0c_XISa5y-YK_lgFHrnJoJv2qNoIpRzbz7SbG0Y85bWi9dvSYdX7O6dYZdHf-NWSxgVRfAzTavBmm6JoECMH8DwI5OjF7Z-b9BqK-QDY-TMRk5E6lAQS4drb5sMC-oKNFr6cBJxJqWwZoKxKrVUI5pddNvXwVQCdjZqQYWgaFAJQTGhjnQYPCs9dNgbA0diFEYNnHVC6C47T8K51yWYqH-_NkW79RKQeY0sLNPY6Cd0ChpzXl48-3N79vqj67Mebdqh_mtyKM6w","e":"AQAB"}]}`
	token := `eyJhbGciOiJSUzI1NiIsImtpZCI6IndZX0t6R3VJVmlmX1ZfSmMtNFBFcjBybTNTZFZ4bF90RzB1QUFkTmE3WDgifQ.eyJhdWQiOlsiaHR0cHM6Ly9jb250YWluZXIuZ29vZ2xlYXBpcy5jb20vdjEvcHJvamVjdHMvdGVsZXBvcnQtZGV2LTMyMDYyMC9sb2NhdGlvbnMvdXMtZWFzdDEtYi9jbHVzdGVycy9odWdvLXRlc3QiXSwiZXhwIjoxNjk4NTA2MDY3LCJpYXQiOjE2NjY5NzAwNjcsImlzcyI6Imh0dHBzOi8vY29udGFpbmVyLmdvb2dsZWFwaXMuY29tL3YxL3Byb2plY3RzL3RlbGVwb3J0LWRldi0zMjA2MjAvbG9jYXRpb25zL3VzLWVhc3QxLWIvY2x1c3RlcnMvaHVnby10ZXN0Iiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJkZWZhdWx0IiwicG9kIjp7Im5hbWUiOiJweXRob24iLCJ1aWQiOiJlMDY3MmEwZi04ZjJlLTRlYjAtYTViYS03N2UzNDIyNTZkMGMifSwic2VydmljZWFjY291bnQiOnsibmFtZSI6ImRlZmF1bHQiLCJ1aWQiOiI2MWVlMTRmYi03NGMwLTRjYzgtOWJiZi04MTUyMWEzNjQ4ZGYifSwid2FybmFmdGVyIjoxNjY2OTczNjc0fSwibmJmIjoxNjY2OTcwMDY3LCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDpkZWZhdWx0In0.a2_lHebeCAob7xug9IiOpdNDYYWAq6uy5cJJijHc4fg7nuV5qm42X053q5FvG_A-iHV15bbUWyHQzvXPXoMc0ccMstp1a7qGNZmgg1B01l6IuAxcPurja1oqm4jKJ1ClMkwxf6YNp3NcQZMvWNRXpgkfZitHlsEPQ7YUvOQ0V9IPsVI1eTSrZWkmMvK_D9KsUsm8CspzaOAR66LaToi3zU0CwFtE8C_uvT6PbuRxrkkNBu4FMEmoQw63mKXINYodYtJgNSTegB5w5-ufhatvatYBh4cw75-yO85jlELeNUVjEcN0hKVmkSQYedY9PTVWzWB7o-BCm5sBJAQ-jVKPvA`

	isValid, payload := validateToken([]byte(token), []byte(jwks))
	require.True(t, isValid)
	t.Log(string(payload))
}
